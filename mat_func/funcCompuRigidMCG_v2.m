function [output] = funcCompuRigidMCG_v2(stateVarArr)
    m2 = (100 + 34*2 + 25*5)/1000; %kg
    m1 = m2;
    h0 = 0.01; %m
    g = 9.8
    Iyy2 = 0;
    Iyy5 = 0;
a1 = 0.02;
for i  =  1:length(stateVarArr)
theta1 = stateVarArr(i,1);
dtheta1 = stateVarArr(i,2);
lc1 = stateVarArr(i,3);
dlc1 = stateVarArr(i,4);
theta2 = stateVarArr(i,5);
dtheta2 = stateVarArr(i,6);
lc2 = stateVarArr(i,7);
dlc2 = stateVarArr(i,8);
b_theta1 = lc1/(theta1)*tan(theta1/2);
b_theta2 = lc2/(theta2)*tan(theta2/2);
q1 = b_theta1; q2 = theta1; q3 = b_theta1;
q4 = b_theta2; q5 = theta2; q6 = b_theta2;
qd1 = (tan(theta1/2)*dlc1/theta1) - (tan(theta1/2)*lc1*dlc1)/theta1^2 + (lc1*(tan(theta1/2)^2 + 1)*dlc1)/(2*theta1);
qd2 = dtheta1;
qd3 =qd1;
qd4 = (tan(theta2/2)*dlc2/theta2) - (tan(theta2/2)*lc2*dlc2)/theta2^2 + (lc2*(tan(theta2/2)^2 + 1)*dlc2)/(2*theta2);
qd5 = dtheta2;
qd6 = qd4;
M6x6{i} = [ m1/2 + m2,- (m2*(sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2 - (m2*((a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)) + sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2 - (m1*sin(q2)*(a1 + q3))/2, (m1*cos(q2))/2 + m2*cos(q2),m2*cos(q2), -(m2*(a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2,(m2*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2;
- (m2*(sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2 - (m2*((a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)) + sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2 - (m1*sin(q2)*(a1 + q3))/2, (m2*(cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4))^2)/2 + (m2*(sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4))^2)/2 + (m2*((a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)) + cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4))^2)/2 + (m2*((a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)) + sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4))^2)/2 + (m2*cos(q2)^2*(2*a1 + q3 + q4)^2)/2 + (m2*sin(q2)^2*(2*a1 + q3 + q4)^2)/2 + m1*cos(q2)^2*(a1 + q3)^2 + (m2*cos(q2)^2*(a1 + q6)^2)/2 + m1*sin(q2)^2*(a1 + q3)^2 + (m2*sin(q2)^2*(a1 + q6)^2)/2, (m2*sin(q2)*(cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 - (m2*cos(q2)*((a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)) + sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2 - (m2*cos(q2)*(sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2 + (m2*sin(q2)*((a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)) + cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2, (m2*sin(q2)*(cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 - (m2*cos(q2)*((a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)) + sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2 - (m2*cos(q2)*(sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2 + (m2*sin(q2)*((a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)) + cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2, (m2*cos(q2)*(a1 + q6)^2*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2 + (m2*sin(q2)*(a1 + q6)^2*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2 + (m2*(a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5))*((a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)) + cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 + (m2*(a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2))*((a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)) + sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2, (m2*(cos(q2)*sin(q5) + cos(q5)*sin(q2))*((a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)) + cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 - (m2*(cos(q2)*cos(q5) - sin(q2)*sin(q5))*((a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)) + sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2;
 (m1*cos(q2))/2 + m2*cos(q2), (m2*sin(q2)*(cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 - (m2*cos(q2)*((a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)) + sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2 - (m2*cos(q2)*(sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2 + (m2*sin(q2)*((a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)) + cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2, (m1*cos(q2)^2)/2 + m2*cos(q2)^2 + (m1*sin(q2)^2)/2 + m2*sin(q2)^2, m2*cos(q2)^2 + m2*sin(q2)^2, (m2*sin(q2)*(a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2 - (m2*cos(q2)*(a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2, (m2*cos(q2)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2 + (m2*sin(q2)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2;
m2*cos(q2), (m2*sin(q2)*(cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 - (m2*cos(q2)*((a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)) + sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2 - (m2*cos(q2)*(sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2 + (m2*sin(q2)*((a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)) + cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2, m2*cos(q2)^2 + m2*sin(q2)^2, m2*cos(q2)^2 + m2*sin(q2)^2, (m2*sin(q2)*(a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2 - (m2*cos(q2)*(a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2, (m2*cos(q2)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2 + (m2*sin(q2)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2;
 -(m2*(a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2, (m2*cos(q2)*(a1 + q6)^2*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2 + (m2*sin(q2)*(a1 + q6)^2*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2 + (m2*(a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5))*((a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)) + cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 + (m2*(a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2))*((a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)) + sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2, (m2*sin(q2)*(a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2 - (m2*cos(q2)*(a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2, (m2*sin(q2)*(a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2 - (m2*cos(q2)*(a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2, m2*(a1 + q6)^2*(cos(q2)*sin(q5) + cos(q5)*sin(q2))^2 + m2*(a1 + q6)^2*(cos(q2)*cos(q5) - sin(q2)*sin(q5))^2, 0;
(m2*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2, (m2*(cos(q2)*sin(q5) + cos(q5)*sin(q2))*((a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)) + cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 - (m2*(cos(q2)*cos(q5) - sin(q2)*sin(q5))*((a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)) + sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2, (m2*cos(q2)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2 + (m2*sin(q2)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2, (m2*cos(q2)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2 + (m2*sin(q2)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2, 0, (m2*(cos(q2)*sin(q5) + cos(q5)*sin(q2))^2)/2 + (m2*(cos(q2)*cos(q5) - sin(q2)*sin(q5))^2)/2;];

C6x6{i} = [ 0, 0, 0, 0, 0, 0;
- qd2*((m2*((a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)) + cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 + (m2*(cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 + (m1*cos(q2)*(a1 + q3))/2) - qd3*((m1*sin(q2))/2 + m2*sin(q2)) - m2*qd4*sin(q2) - (m2*qd6*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2 - (m2*qd5*(a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2, qd3*((m1*sin(q2)^2*(2*a1 + 2*q3))/2 + (m2*sin(q2)*((a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)) + sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2 + (m2*cos(q2)^2*(4*a1 + 2*q3 + 2*q4))/4 + (m2*cos(q2)*(cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 + (m2*sin(q2)^2*(4*a1 + 2*q3 + 2*q4))/4 + (m2*cos(q2)*((a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)) + cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 + (m1*cos(q2)^2*(2*a1 + 2*q3))/2 + (m2*sin(q2)*(sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2) - qd5*((m2*(a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2))*((a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)) + cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 - (m2*(a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5))*((a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)) + sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2) + qd4*((m2*sin(q2)*((a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)) + sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2 + (m2*cos(q2)^2*(4*a1 + 2*q3 + 2*q4))/4 + (m2*cos(q2)*(cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 + (m2*sin(q2)^2*(4*a1 + 2*q3 + 2*q4))/4 + (m2*cos(q2)*((a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)) + cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 + (m2*sin(q2)*(sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2) + qd6*((m2*sin(q2)^2*(2*a1 + 2*q6))/4 + (m2*(cos(q2)*cos(q5) - sin(q2)*sin(q5))*((a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)) + cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 + (m2*(cos(q2)*sin(q5) + cos(q5)*sin(q2))*((a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)) + sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2 + (m2*cos(q2)^2*(2*a1 + 2*q6))/4), - qd5*((m2*cos(q2)*(a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2 + (m2*sin(q2)*(a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2) - qd2*((m1*sin(q2)^2*(2*a1 + 2*q3))/2 + (m2*sin(q2)*((a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)) + sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2 + (m2*cos(q2)^2*(4*a1 + 2*q3 + 2*q4))/4 + (m2*cos(q2)*(cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 + (m2*sin(q2)^2*(4*a1 + 2*q3 + 2*q4))/4 + (m2*cos(q2)*((a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)) + cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 + (m1*cos(q2)^2*(2*a1 + 2*q3))/2 + (m2*sin(q2)*(sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2) - qd6*((m2*cos(q2)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2 - (m2*sin(q2)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2), - qd5*((m2*cos(q2)*(a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2 + (m2*sin(q2)*(a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2) - qd2*((m2*sin(q2)*((a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)) + sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2 + (m2*cos(q2)^2*(4*a1 + 2*q3 + 2*q4))/4 + (m2*cos(q2)*(cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 + (m2*sin(q2)^2*(4*a1 + 2*q3 + 2*q4))/4 + (m2*cos(q2)*((a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)) + cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 + (m2*sin(q2)*(sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2) - qd6*((m2*cos(q2)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2 - (m2*sin(q2)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2), qd2*((m2*(a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2))*((a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)) + cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 - (m2*(a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5))*((a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)) + sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2) + qd3*((m2*cos(q2)*(a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2 + (m2*sin(q2)*(a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2) + qd4*((m2*cos(q2)*(a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2 + (m2*sin(q2)*(a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2) + qd6*((m2*(a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2))^2)/2 + (m2*(a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5))^2)/2 + (m2*cos(q2)*(cos(q2)*cos(q5) - sin(q2)*sin(q5))*(2*a1 + 2*q6))/4 + (m2*sin(q2)*(cos(q2)*sin(q5) + cos(q5)*sin(q2))*(2*a1 + 2*q6))/4), qd3*((m2*cos(q2)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2 - (m2*sin(q2)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2) - qd2*((m2*sin(q2)^2*(2*a1 + 2*q6))/4 + (m2*(cos(q2)*cos(q5) - sin(q2)*sin(q5))*((a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)) + cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 + (m2*(cos(q2)*sin(q5) + cos(q5)*sin(q2))*((a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)) + sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2 + (m2*cos(q2)^2*(2*a1 + 2*q6))/4) - qd5*((m2*(a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2))^2)/2 + (m2*(a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5))^2)/2 + (m2*cos(q2)*(cos(q2)*cos(q5) - sin(q2)*sin(q5))*(2*a1 + 2*q6))/4 + (m2*sin(q2)*(cos(q2)*sin(q5) + cos(q5)*sin(q2))*(2*a1 + 2*q6))/4) + qd4*((m2*cos(q2)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2 - (m2*sin(q2)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2);
 -qd2*((m1*sin(q2))/2 + m2*sin(q2)), qd2*((m1*sin(q2)^2*(2*a1 + 2*q3))/2 + (m2*sin(q2)*((a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)) + sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2 + (m2*cos(q2)^2*(4*a1 + 2*q3 + 2*q4))/4 + (m2*cos(q2)*(cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 + (m2*sin(q2)^2*(4*a1 + 2*q3 + 2*q4))/4 + (m2*cos(q2)*((a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)) + cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 + (m1*cos(q2)^2*(2*a1 + 2*q3))/2 + (m2*sin(q2)*(sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2), 0, 0, qd2*((m2*cos(q2)*(a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2 + (m2*sin(q2)*(a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2), qd2*((m2*cos(q2)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2 - (m2*sin(q2)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2);
-m2*qd2*sin(q2), qd2*((m2*sin(q2)*((a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)) + sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2 + (m2*cos(q2)^2*(4*a1 + 2*q3 + 2*q4))/4 + (m2*cos(q2)*(cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 + (m2*sin(q2)^2*(4*a1 + 2*q3 + 2*q4))/4 + (m2*cos(q2)*((a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)) + cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 + (m2*sin(q2)*(sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2), 0, 0, qd2*((m2*cos(q2)*(a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2 + (m2*sin(q2)*(a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2), qd2*((m2*cos(q2)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2 - (m2*sin(q2)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2);
 - (m2*qd6*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2 - (m2*qd2*(a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2 - (m2*qd5*(a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2, qd6*((m2*(cos(q2)*cos(q5) - sin(q2)*sin(q5))*((a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)) + cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 + (m2*(cos(q2)*sin(q5) + cos(q5)*sin(q2))*((a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)) + sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2 + (m2*cos(q2)*(cos(q2)*cos(q5) - sin(q2)*sin(q5))*(2*a1 + 2*q6))/4 + (m2*sin(q2)*(cos(q2)*sin(q5) + cos(q5)*sin(q2))*(2*a1 + 2*q6))/4) - qd5*((m2*cos(q2)*(a1 + q6)^2*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2 - (m2*sin(q2)*(a1 + q6)^2*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2 + (m2*(a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2))*((a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)) + cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 - (m2*(a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5))*((a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)) + sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2) - qd2*((m2*(a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2))*((a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)) + cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 - (m2*(a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5))*((a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)) + sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2), - qd2*((m2*cos(q2)*(a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2 + (m2*sin(q2)*(a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2) - qd5*((m2*cos(q2)*(a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2 + (m2*sin(q2)*(a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2) - qd6*((m2*cos(q2)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2 - (m2*sin(q2)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2), - qd2*((m2*cos(q2)*(a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2 + (m2*sin(q2)*(a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2) - qd5*((m2*cos(q2)*(a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2 + (m2*sin(q2)*(a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2) - qd6*((m2*cos(q2)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2 - (m2*sin(q2)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2), qd6*((m2*(cos(q2)*sin(q5) + cos(q5)*sin(q2))^2*(2*a1 + 2*q6))/2 + (m2*(cos(q2)*cos(q5) - sin(q2)*sin(q5))^2*(2*a1 + 2*q6))/2), - qd2*((m2*(a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2))^2)/2 + (m2*(a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5))^2)/2 + (m2*cos(q2)*(cos(q2)*cos(q5) - sin(q2)*sin(q5))*(2*a1 + 2*q6))/4 + (m2*sin(q2)*(cos(q2)*sin(q5) + cos(q5)*sin(q2))*(2*a1 + 2*q6))/4) - qd5*((m2*(cos(q2)*sin(q5) + cos(q5)*sin(q2))^2*(2*a1 + 2*q6))/2 + (m2*(cos(q2)*cos(q5) - sin(q2)*sin(q5))^2*(2*a1 + 2*q6))/2);
- (m2*qd2*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2 - (m2*qd5*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2, qd2*((m2*sin(q2)^2*(2*a1 + 2*q6))/4 + (m2*(cos(q2)*cos(q5) - sin(q2)*sin(q5))*((a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)) + cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 + (m2*(cos(q2)*sin(q5) + cos(q5)*sin(q2))*((a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)) + sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2 + (m2*cos(q2)^2*(2*a1 + 2*q6))/4) + qd5*((m2*(cos(q2)*cos(q5) - sin(q2)*sin(q5))*((a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)) + cos(q2)*(a1 + q3) + cos(q2)*(a1 + q4)))/2 + (m2*(cos(q2)*sin(q5) + cos(q5)*sin(q2))*((a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)) + sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2 + (m2*cos(q2)*(cos(q2)*cos(q5) - sin(q2)*sin(q5))*(2*a1 + 2*q6))/4 + (m2*sin(q2)*(cos(q2)*sin(q5) + cos(q5)*sin(q2))*(2*a1 + 2*q6))/4), - qd2*((m2*cos(q2)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2 - (m2*sin(q2)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2) - qd5*((m2*cos(q2)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2 - (m2*sin(q2)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2), - qd2*((m2*cos(q2)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2 - (m2*sin(q2)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2) - qd5*((m2*cos(q2)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2 - (m2*sin(q2)*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2), qd2*((m2*(a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2))^2)/2 + (m2*(a1 + q6)*(cos(q2)*cos(q5) - sin(q2)*sin(q5))^2)/2 + (m2*cos(q2)*(cos(q2)*cos(q5) - sin(q2)*sin(q5))*(2*a1 + 2*q6))/4 + (m2*sin(q2)*(cos(q2)*sin(q5) + cos(q5)*sin(q2))*(2*a1 + 2*q6))/4) + qd5*((m2*(cos(q2)*sin(q5) + cos(q5)*sin(q2))^2*(2*a1 + 2*q6))/2 + (m2*(cos(q2)*cos(q5) - sin(q2)*sin(q5))^2*(2*a1 + 2*q6))/2), 0;
];

G6x1{i}= [                                                                                                                                                                   (g*m1)/2 + g*m2;
- (g*m2*(sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2 - (g*m2*((a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)) + sin(q2)*(a1 + q3) + sin(q2)*(a1 + q4)))/2 - (g*m1*sin(q2)*(a1 + q3))/2;
                                                                                                                                                   (g*m1*cos(q2))/2 + g*m2*cos(q2);
                                                                                                                                                                      g*m2*cos(q2);
                                                                                                                           -(g*m2*(a1 + q6)*(cos(q2)*sin(q5) + cos(q5)*sin(q2)))/2;
                                                                                                                                      (g*m2*(cos(q2)*cos(q5) - sin(q2)*sin(q5)))/2;];
output.detM(i) = det(M6x6{i});
output.detC(i) = det(C6x6{i});
output.rankM(i) = rank(M6x6{i});
% output.detG(i) = det(G4x1{i});
end

end

