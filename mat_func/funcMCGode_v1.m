function dxdt = funcMCGode_v1(t,x)
    m2 = (100 + 34*2 + 25*5)/1000; %kg
    m1 = m2;
    g = 9.8;
    Iyy2 = 0;
    Iyy5 = 0;
a1 = 0.02;
theta1 = x(1);
dtheta1 = x(2);
lc1 = x(3);
dlc1 = x(4);
theta2 = x(5);
dtheta2 = x(6);
lc2 = x(7);
dlc2 = x(8);


M4x4 = [m2*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2))^2 + m2*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2))^2 + (m2*sin(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)) - m2*cos(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2) + ((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*(((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*(m2*cos(theta1)^2 + m2*sin(theta1)^2) + m2*sin(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)) - m2*cos(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)) + m2*cos(theta1)*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)) + Iyy2*cos(theta1)^2 + Iyy5*cos(theta1)^2 + ((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((m1 + m2)*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2) - m2*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)) + m2*cos(theta1)*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)) + Iyy2*sin(theta1)^2 + Iyy5*sin(theta1)^2 - m2*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2))*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2), (tan(theta1/2)*(((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*(m2*cos(theta1)^2 + m2*sin(theta1)^2) + m2*sin(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)) - m2*cos(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)) + m2*cos(theta1)*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)))/theta1 + (tan(theta1/2)*((m1 + m2)*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2) - m2*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)) + m2*cos(theta1)*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)))/theta1, ((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*(((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*(m2*cos(theta1)^2 + m2*sin(theta1)^2) + m2*sin(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)) - m2*cos(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)) + m2*cos(theta1)*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)) + Iyy5*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + Iyy5*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)), (tan(theta2/2)*(((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*(m2*cos(theta1)^2 + m2*sin(theta1)^2) + m2*sin(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)) - m2*cos(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)) + m2*cos(theta1)*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)))/theta2;
 ((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((tan(theta1/2)*(m1 + m2))/theta1 + (m2*tan(theta1/2)*cos(theta1))/theta1) + ((tan(theta1/2)*(m2*cos(theta1)^2 + m2*sin(theta1)^2))/theta1 + (m2*tan(theta1/2)*cos(theta1))/theta1)*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2) + (tan(theta1/2)*(m2*sin(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)) - m2*cos(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2))))/theta1 - (m2*tan(theta1/2)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/theta1,(tan(theta1/2)*((tan(theta1/2)*(m1 + m2))/theta1 + (m2*tan(theta1/2)*cos(theta1))/theta1))/theta1 + (tan(theta1/2)*((tan(theta1/2)*(m2*cos(theta1)^2 + m2*sin(theta1)^2))/theta1 + (m2*tan(theta1/2)*cos(theta1))/theta1))/theta1, ((tan(theta1/2)*(m2*cos(theta1)^2 + m2*sin(theta1)^2))/theta1 + (m2*tan(theta1/2)*cos(theta1))/theta1)*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2), (tan(theta2/2)*((tan(theta1/2)*(m2*cos(theta1)^2 + m2*sin(theta1)^2))/theta1 + (m2*tan(theta1/2)*cos(theta1))/theta1))/theta2;
 (m2*sin(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)) - m2*cos(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + Iyy5*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)) + Iyy5*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)) + ((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*(m2*cos(theta1)^2 + m2*sin(theta1)^2) + m2*cos(theta1)*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2), (tan(theta1/2)*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*(m2*cos(theta1)^2 + m2*sin(theta1)^2))/theta1 + (m2*tan(theta1/2)*cos(theta1)*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2))/theta1,((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)^2*(m2*cos(theta1)^2 + m2*sin(theta1)^2) + Iyy5*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2 + Iyy5*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2,(tan(theta2/2)*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*(m2*cos(theta1)^2 + m2*sin(theta1)^2))/theta2;
(tan(theta2/2)*(m2*sin(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)) - m2*cos(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2))))/theta2 + (tan(theta2/2)*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*(m2*cos(theta1)^2 + m2*sin(theta1)^2))/theta2 + (m2*tan(theta2/2)*cos(theta1)*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2))/theta2, (tan(theta1/2)*tan(theta2/2)*(m2*cos(theta1)^2 + m2*sin(theta1)^2))/(theta1*theta2) + (m2*tan(theta1/2)*tan(theta2/2)*cos(theta1))/(theta1*theta2), (tan(theta2/2)*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*(m2*cos(theta1)^2 + m2*sin(theta1)^2))/theta2,(tan(theta2/2)^2*(m2*cos(theta1)^2 + m2*sin(theta1)^2))/theta2^2;];
C4x4 = [(m2*cos(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)) + m2*sin(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))*(dtheta1*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2) + (dlc1*tan(theta1/2))/theta1) + (m2*cos(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)) + m2*sin(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))*(dtheta2*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + (dlc2*tan(theta2/2))/theta2) - ((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*(m2*sin(theta1)*(dtheta1*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2) + (dlc1*tan(theta1/2))/theta1) + m2*sin(theta1)*(dtheta2*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + (dlc2*tan(theta2/2))/theta2) + dtheta1*m2*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)) + dtheta1*m2*sin(theta1)*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)), - (tan(theta1/2)*(m2*sin(theta1)*(dtheta1*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2) + (dlc1*tan(theta1/2))/theta1) + m2*sin(theta1)*(dtheta2*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + (dlc2*tan(theta2/2))/theta2) + dtheta1*m2*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)) + dtheta1*m2*sin(theta1)*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)))/theta1 - (dtheta1*tan(theta1/2)*(m2*cos(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)) + m2*sin(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2))))/theta1, -dtheta1*(m2*cos(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)) + m2*sin(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2), -(dtheta1*tan(theta2/2)*(m2*cos(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)) + m2*sin(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2))))/theta2;
 (dtheta1*tan(theta1/2)*(m2*cos(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)) + m2*sin(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2))))/theta1 - (dtheta1*m2*tan(theta1/2)*sin(theta1)*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2))/theta1,-(dtheta1*m2*tan(theta1/2)^2*sin(theta1))/theta1^2,0, 0;
 dtheta1*(m2*cos(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)) + m2*sin(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) - dtheta2*(Iyy5*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)) - Iyy5*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))) - dtheta1*m2*sin(theta1)*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2),-(dtheta1*m2*tan(theta1/2)*sin(theta1)*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2))/theta1,0, 0;
 (dtheta1*tan(theta2/2)*(m2*cos(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)) + m2*sin(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2))))/theta2 - (dtheta1*m2*tan(theta2/2)*sin(theta1)*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2))/theta2, -(dtheta1*m2*tan(theta1/2)*tan(theta2/2)*sin(theta1))/(theta1*theta2),0, 0;
 ];
G4x1= [((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*(g*m1 + g*m2) - g*m2*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)) + g*m2*cos(theta1)*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2);
 (tan(theta1/2)*(g*m1 + g*m2))/theta1 + (g*m2*tan(theta1/2)*cos(theta1))/theta1;
 g*m2*cos(theta1)*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2);
(g*m2*tan(theta2/2)*cos(theta1))/theta2;];
temp_dxdt = -M4x4\(C4x4*[x(2);x(4);x(6);x(8);] + G4x1);
dxdt = [x(2);temp_dxdt(1);
        x(4);temp_dxdt(2);
        x(6);temp_dxdt(3);
        x(8);temp_dxdt(4);];
end


