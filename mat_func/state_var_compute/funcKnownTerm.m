function [output] = funcKnownTerm(testData)

% State equations.
    m0 = (100 + 34*2 + 25*5)/1000; %kg
    h0 = 0.01; %m
    g = 9.8; %N/kg
    timestamp=testData.time_stamp;%sec
    Ts=timestamp(2)-timestamp(1);
    %%%%% calculate tau, fz, theta and lc
    s1.l_t0 = 205.7796;s1.r_t0 = 209.0839; 
    s2.l_t0 = 223.6281;s2.r_t0 = 222.3360;
    r0 = 43;
    green_t0 = 31.92;yellow_t0 = 46.33; purple_t0 =21.99;
    s1.red_l = s1.l_t0 - green_t0;
    s1.red_r = s1.r_t0 - green_t0;
    s2.red_l = s2.l_t0 - yellow_t0 - purple_t0 - green_t0;
    s2.red_r = s2.r_t0 - yellow_t0 - purple_t0 - green_t0;
    
    s1.l_t = testData.enco_volts(:,1)/5*1000 - s1.red_l;
    s1.r_t = testData.enco_volts(:,2)/5*1000 - s1.red_r;
    
    s2.l_t = testData.enco_volts(:,4)/5*1000 - purple_t0 - s1.l_t - s2.red_l;
    s2.r_t = testData.enco_volts(:,3)/5*1000 - purple_t0 - s1.r_t - s2.red_r;
    
    s1.theta_wire_rad = (s1.r_t - s1.l_t)/r0;
    s1.l_wire_mm = (s1.r_t + s1.l_t)/2;
    
    s2.theta_wire_rad = (s2.r_t - s2.l_t)/r0;
    s2.l_wire_mm = (s2.r_t + s2.l_t)/2;
    theta1_array = s1.theta_wire_rad;
    theta2_array = s2.theta_wire_rad;
    lc1_array = s1.l_wire_mm/1000;
    lc2_array = s2.l_wire_mm/1000;
    dtheta1_array = zeros(length(theta1_array),1);
    dtheta2_array = zeros(length(theta1_array),1);
    ddtheta1_array = zeros(length(theta1_array),1);
    ddtheta2_array = zeros(length(theta1_array),1);
    dlc1_array = zeros(length(theta1_array),1);
    dlc2_array = zeros(length(theta1_array),1);
    ddlc1_array = zeros(length(theta1_array),1);
    ddlc2_array = zeros(length(theta1_array),1);
    for i = 1:length(s1.theta_wire_rad)
        if i ==1
            dtheta1_array(i,1) = 0; dtheta2_array(i,1) = 0; 
            ddtheta1_array(i,1) = 0; ddtheta2_array(i,1) = 0;

            dlc1_array(i,1) = 0; dlc2_array(i,1) = 0;
            ddlc1_array(i,1) = 0; ddlc2_array(i,1) =0;
        else
            dtheta1_array(i,1) = (theta1_array(i,1)-theta1_array(i-1))/Ts; dtheta2_array(i,1) = (theta2_array(i,1)-theta2_array(i-1))/Ts; 
            ddtheta1_array(i,1) =  (dtheta1_array(i,1)-dtheta1_array(i-1))/Ts; ddtheta2_array(i,1) =  (dtheta2_array(i,1)-dtheta2_array(i-1))/Ts;

            dlc1_array(i,1) = (lc1_array(i)-lc1_array(i-1))/Ts;dlc2_array(i,1) = (lc2_array(i)-lc2_array(i-1))/Ts;
            ddlc1_array(i,1) = (dlc1_array(i)-dlc1_array(i-1))/Ts; ddlc2_array(i,1) =(dlc2_array(i,1)-dlc2_array(i-1))/Ts;
        end 
    theta1 = theta1_array(i);lc1 = lc1_array(i);dtheta1 = dtheta1_array(i);dlc1 = dlc1_array(i);ddtheta1 = ddtheta1_array(i);ddlc1 = ddlc1_array(i);
    theta2 = theta2_array(i);lc2 = lc2_array(i);dtheta2 = dtheta2_array(i);dlc2 = dlc2_array(i);ddtheta2 = ddtheta2_array(i);ddlc2 = ddlc2_array(i);
    if theta1 <= 0.005
        r3 = 0.5 * lc1;
    else
        r3 = lc1/(theta1)*sin(theta1/2);
    end
    if theta2 <= 0.005
        r6 = 0.5*lc2;
    else
        r6 = lc2/(theta2)*sin(theta2/2);
    end
        Iyy3 = m0 * r3^2;
        Iyy6 = 0.5 * m0 * r6^2;
if theta1 <= 0.005
M = [Iyy3 + Iyy6 + (m0*(2*h0 + lc1/2 + lc2/2 + cos(theta2)*(h0 + lc2/2))^2)/2 + m0*(h0 + lc1/2)^2 + (m0*sin(theta2)^2*(h0 + lc2/2)^2)/2, -(m0*sin(theta2)*(h0 + lc2/2))/2, Iyy6 + (m0*sin(theta2)^2*(h0 + lc2/2)^2)/2 + (m0*cos(theta2)*(h0 + lc2/2)*(2*h0 + lc1/2 + lc2/2 + cos(theta2)*(h0 + lc2/2)))/2, (m0*sin(theta2)*(2*h0 + lc1/2 + lc2/2 + cos(theta2)*(h0 + lc2/2)))/4 - (m0*sin(theta2)*(h0 + lc2/2))/4 - (m0*cos(theta2)*sin(theta2)*(h0 + lc2/2))/4;
-(m0*sin(theta2)*(h0 + lc2/2))/2,(13*m0)/8, -(m0*sin(theta2)*(h0 + lc2/2))/2, m0/4 + (m0*cos(theta2))/4;
Iyy6 + (m0*sin(theta2)^2*(h0 + lc2/2)^2)/2 + (m0*cos(theta2)*(h0 + lc2/2)*(2*h0 + lc1/2 + lc2/2 + cos(theta2)*(h0 + lc2/2)))/2, -(m0*sin(theta2)*(h0 + lc2/2))/2,Iyy6 + (m0*sin(theta2)^2*(h0 + lc2/2)^2)/2 + (m0*cos(theta2)^2*(h0 + lc2/2)^2)/2, -(m0*sin(theta2)*(h0 + lc2/2))/4;
 (m0*sin(theta2)*(2*h0 + lc1/2 + lc2/2 + cos(theta2)*(h0 + lc2/2)))/4 - (m0*sin(theta2)*(h0 + lc2/2))/4 - (m0*cos(theta2)*sin(theta2)*(h0 + lc2/2))/4,m0/4 + (m0*cos(theta2))/4,-(m0*sin(theta2)*(h0 + lc2/2))/4, m0/8 + (m0*cos(theta2)^2)/8 + (m0*sin(theta2)^2)/8 + (m0*cos(theta2))/4];

C = [dtheta2*((m0*cos(theta2)*sin(theta2)*(h0 + lc2/2)^2)/2 - (m0*sin(theta2)*(h0 + lc2/2)*(2*h0 + lc1/2 + lc2/2 + cos(theta2)*(h0 + lc2/2)))/2) + (dlc1*((m0*(2*h0 + lc1/2 + lc2/2 + cos(theta2)*(h0 + lc2/2)))/2 + (m0*(2*h0 + lc1))/2))/2 + (dlc2*((m0*cos(theta2)*(2*h0 + lc1/2 + lc2/2 + cos(theta2)*(h0 + lc2/2)))/2 + (m0*sin(theta2)^2*(h0 + lc2/2))/2))/2 + (dlc2*m0*(2*h0 + lc1/2 + lc2/2 + cos(theta2)*(h0 + lc2/2)))/4, - (dtheta1*((m0*(2*h0 + lc1/2 + lc2/2 + cos(theta2)*(h0 + lc2/2)))/2 + m0*(h0 + lc1/2)))/2 - (dtheta1*((m0*(2*h0 + lc1/2 + lc2/2 + cos(theta2)*(h0 + lc2/2)))/2 + (m0*(2*h0 + lc1))/2))/2 - (dlc2*m0*sin(theta2))/4 - (dtheta2*m0*cos(theta2)*(h0 + lc2/2))/2, (dlc2*((m0*cos(theta2)^2*(h0 + lc2/2))/2 + (m0*sin(theta2)^2*(h0 + lc2/2))/2))/2 - dtheta1*((m0*cos(theta2)*sin(theta2)*(h0 + lc2/2)^2)/2 - (m0*sin(theta2)*(h0 + lc2/2)*(2*h0 + lc1/2 + lc2/2 + cos(theta2)*(h0 + lc2/2)))/2) + (dlc1*m0*cos(theta2)*(h0 + lc2/2))/4 + (dlc2*m0*cos(theta2)*(h0 + lc2/2))/4, (dlc1*m0*sin(theta2))/8 - (dtheta1*((m0*cos(theta2)*(2*h0 + lc1/2 + lc2/2 + cos(theta2)*(h0 + lc2/2)))/2 + (m0*sin(theta2)^2*(h0 + lc2/2))/2))/2 - (dtheta2*((m0*cos(theta2)^2*(h0 + lc2/2))/2 + (m0*sin(theta2)^2*(h0 + lc2/2))/2))/2 - (dtheta1*m0*(2*h0 + lc1/2 + lc2/2 + cos(theta2)*(h0 + lc2/2)))/4 - (dtheta2*m0*cos(theta2)*(h0 + lc2/2))/4;
 (dtheta1*((m0*(2*h0 + lc1/2 + lc2/2 + cos(theta2)*(h0 + lc2/2)))/2 + (m0*(2*h0 + lc1))/2))/2, 0,(dtheta1*m0*cos(theta2)*(h0 + lc2/2))/4,(dtheta1*m0*sin(theta2))/8;
dtheta1*((m0*cos(theta2)*sin(theta2)*(h0 + lc2/2)^2)/2 - (m0*sin(theta2)*(h0 + lc2/2)*(2*h0 + lc1/2 + lc2/2 + cos(theta2)*(h0 + lc2/2)))/2) + dtheta2*((m0*cos(theta2)*sin(theta2)*(h0 + lc2/2)^2)/2 - (m0*sin(theta2)*(h0 + lc2/2)*(2*h0 + lc1/2 + lc2/2 + cos(theta2)*(h0 + lc2/2)))/2) + (dlc2*((m0*cos(theta2)*(2*h0 + lc1/2 + lc2/2 + cos(theta2)*(h0 + lc2/2)))/2 + (m0*sin(theta2)^2*(h0 + lc2/2))/2))/2, - (dlc2*m0*sin(theta2))/4 - (dtheta1*m0*cos(theta2)*(h0 + lc2/2))/2 - (dtheta2*m0*cos(theta2)*(h0 + lc2/2))/2, (dlc2*((m0*cos(theta2)^2*(2*h0 + lc2))/4 + (m0*sin(theta2)^2*(2*h0 + lc2))/4))/2, - (dtheta1*((m0*cos(theta2)^2*(h0 + lc2/2))/2 + (m0*sin(theta2)^2*(h0 + lc2/2))/2))/2 - (dtheta2*((m0*cos(theta2)^2*(2*h0 + lc2))/4 + (m0*sin(theta2)^2*(2*h0 + lc2))/4))/2 - (dlc2*m0*sin(theta2))/8 - (dtheta1*m0*cos(theta2)*(h0 + lc2/2))/4 - (dtheta2*m0*cos(theta2)*(h0 + lc2/2))/4;
 (dtheta1*((m0*cos(theta2)*(2*h0 + lc1/2 + lc2/2 + cos(theta2)*(h0 + lc2/2)))/2 + (m0*sin(theta2)^2*(h0 + lc2/2))/2))/2 + (dtheta2*((m0*cos(theta2)*(2*h0 + lc1/2 + lc2/2 + cos(theta2)*(h0 + lc2/2)))/2 + (m0*sin(theta2)^2*(h0 + lc2/2))/2))/2 + (dtheta1*m0*(2*h0 + lc1/2 + lc2/2 + cos(theta2)*(h0 + lc2/2)))/4, - (dtheta1*m0*sin(theta2))/4 - (dtheta2*m0*sin(theta2))/4,(dtheta1*((m0*cos(theta2)^2*(h0 + lc2/2))/2 + (m0*sin(theta2)^2*(h0 + lc2/2))/2))/2 + (dtheta2*((m0*cos(theta2)^2*(2*h0 + lc2))/4 + (m0*sin(theta2)^2*(2*h0 + lc2))/4))/2 + (dtheta1*m0*cos(theta2)*(h0 + lc2/2))/4, -(dtheta2*m0*sin(theta2))/8];
 
G = [-(g*m0*sin(theta2)*(h0 + lc2/2))/2;
(3*g*m0)/2;
-(g*m0*sin(theta2)*(h0 + lc2/2))/2;
 (g*m0)/4 + (g*m0*cos(theta2))/4];

elseif theta2 <= 0.005

M = [ Iyy3 + Iyy6 + (m0*(cos(theta1)*(h0 + lc1/2) + 2*cos(theta1)*(h0 + lc2/2))^2)/2 + (m0*(sin(theta1)*(h0 + lc1/2) + 2*sin(theta1)*(h0 + lc2/2))^2)/2 + m0*sin(theta1)^2*(h0 + lc1/2)^2 + m0*cos(theta1)^2*(h0 + lc1/2)^2, (m0*sin(theta1)*(cos(theta1)*(h0 + lc1/2) + 2*cos(theta1)*(h0 + lc2/2)))/4 - (m0*sin(theta1)*(h0 + lc1/2))/2 - (m0*(sin(theta1)*(h0 + lc1/2) + 2*sin(theta1)*(h0 + lc2/2)))/4 - (m0*cos(theta1)*(sin(theta1)*(h0 + lc1/2) + 2*sin(theta1)*(h0 + lc2/2)))/4, Iyy6 + (m0*cos(theta1)*(h0 + lc2/2)*(cos(theta1)*(h0 + lc1/2) + 2*cos(theta1)*(h0 + lc2/2)))/2 + (m0*sin(theta1)*(sin(theta1)*(h0 + lc1/2) + 2*sin(theta1)*(h0 + lc2/2))*(h0 + lc2/2))/2, (m0*sin(theta1)*(cos(theta1)*(h0 + lc1/2) + 2*cos(theta1)*(h0 + lc2/2)))/2 - (m0*cos(theta1)*(sin(theta1)*(h0 + lc1/2) + 2*sin(theta1)*(h0 + lc2/2)))/2;
(m0*sin(theta1)*(cos(theta1)*(h0 + lc1/2) + 2*cos(theta1)*(h0 + lc2/2)))/4 - (m0*sin(theta1)*(h0 + lc1/2))/2 - (m0*(sin(theta1)*(h0 + lc1/2) + 2*sin(theta1)*(h0 + lc2/2)))/4 - (m0*cos(theta1)*(sin(theta1)*(h0 + lc1/2) + 2*sin(theta1)*(h0 + lc2/2)))/4,m0/2 + (3*m0*cos(theta1)^2)/8 + (3*m0*sin(theta1)^2)/8 + (3*m0*cos(theta1))/4, -(m0*sin(theta1)*(h0 + lc2/2))/4,(m0*cos(theta1)^2)/4 + (m0*sin(theta1)^2)/4 + (m0*cos(theta1))/4;
Iyy6 + (m0*cos(theta1)*(h0 + lc2/2)*(cos(theta1)*(h0 + lc1/2) + 2*cos(theta1)*(h0 + lc2/2)))/2 + (m0*sin(theta1)*(sin(theta1)*(h0 + lc1/2) + 2*sin(theta1)*(h0 + lc2/2))*(h0 + lc2/2))/2, -(m0*sin(theta1)*(h0 + lc2/2))/4, Iyy6 + (m0*sin(theta1)^2*(h0 + lc2/2)^2)/2 + (m0*cos(theta1)^2*(h0 + lc2/2)^2)/2, 0;
(m0*sin(theta1)*(cos(theta1)*(h0 + lc1/2) + 2*cos(theta1)*(h0 + lc2/2)))/2 - (m0*cos(theta1)*(sin(theta1)*(h0 + lc1/2) + 2*sin(theta1)*(h0 + lc2/2)))/2, (m0*cos(theta1)^2)/4 + (m0*sin(theta1)^2)/4 + (m0*cos(theta1))/4,0, (m0*cos(theta1)^2)/2 + (m0*sin(theta1)^2)/2];
 
C = [dlc2*((m0*cos(theta1)*(cos(theta1)*(h0 + lc1/2) + 2*cos(theta1)*(h0 + lc2/2)))/2 + (m0*sin(theta1)*(sin(theta1)*(h0 + lc1/2) + 2*sin(theta1)*(h0 + lc2/2)))/2) - dtheta2*((m0*sin(theta1)*(h0 + lc2/2)*(cos(theta1)*(h0 + lc1/2) + 2*cos(theta1)*(h0 + lc2/2)))/2 - (m0*cos(theta1)*(sin(theta1)*(h0 + lc1/2) + 2*sin(theta1)*(h0 + lc2/2))*(h0 + lc2/2))/2) + (dlc1*((m0*cos(theta1)^2*(2*h0 + lc1))/2 + (m0*cos(theta1)*(cos(theta1)*(h0 + lc1/2) + 2*cos(theta1)*(h0 + lc2/2)))/2 + (m0*sin(theta1)^2*(2*h0 + lc1))/2 + (m0*sin(theta1)*(sin(theta1)*(h0 + lc1/2) + 2*sin(theta1)*(h0 + lc2/2)))/2))/2, - (dtheta1*((m0*(cos(theta1)*(h0 + lc1/2) + 2*cos(theta1)*(h0 + lc2/2)))/2 + m0*cos(theta1)*(h0 + lc1/2)))/2 - (dtheta2*((m0*cos(theta1)^2*(h0 + lc2/2))/2 + (m0*sin(theta1)^2*(h0 + lc2/2))/2))/2 - (dtheta1*((m0*cos(theta1)^2*(2*h0 + lc1))/2 + (m0*cos(theta1)*(cos(theta1)*(h0 + lc1/2) + 2*cos(theta1)*(h0 + lc2/2)))/2 + (m0*sin(theta1)^2*(2*h0 + lc1))/2 + (m0*sin(theta1)*(sin(theta1)*(h0 + lc1/2) + 2*sin(theta1)*(h0 + lc2/2)))/2))/2 - (3*dlc1*m0*sin(theta1))/8 - (dlc2*m0*sin(theta1))/4 - (dtheta2*m0*cos(theta1)*(h0 + lc2/2))/4, (dlc1*((m0*cos(theta1)^2*(h0 + lc2/2))/2 + (m0*sin(theta1)^2*(h0 + lc2/2))/2))/2 + dlc2*((m0*cos(theta1)^2*(h0 + lc2/2))/2 + (m0*sin(theta1)^2*(h0 + lc2/2))/2) + dtheta1*((m0*sin(theta1)*(h0 + lc2/2)*(cos(theta1)*(h0 + lc1/2) + 2*cos(theta1)*(h0 + lc2/2)))/2 - (m0*cos(theta1)*(sin(theta1)*(h0 + lc1/2) + 2*sin(theta1)*(h0 + lc2/2))*(h0 + lc2/2))/2), - dtheta2*((m0*cos(theta1)^2*(h0 + lc2/2))/2 + (m0*sin(theta1)^2*(h0 + lc2/2))/2) - dtheta1*((m0*cos(theta1)*(cos(theta1)*(h0 + lc1/2) + 2*cos(theta1)*(h0 + lc2/2)))/2 + (m0*sin(theta1)*(sin(theta1)*(h0 + lc1/2) + 2*sin(theta1)*(h0 + lc2/2)))/2);
(dtheta1*((m0*cos(theta1)^2*(2*h0 + lc1))/2 + (m0*cos(theta1)*(cos(theta1)*(h0 + lc1/2) + 2*cos(theta1)*(h0 + lc2/2)))/2 + (m0*sin(theta1)^2*(2*h0 + lc1))/2 + (m0*sin(theta1)*(sin(theta1)*(h0 + lc1/2) + 2*sin(theta1)*(h0 + lc2/2)))/2))/2,-(3*dtheta1*m0*sin(theta1))/8, (dtheta1*((m0*cos(theta1)^2*(h0 + lc2/2))/2 + (m0*sin(theta1)^2*(h0 + lc2/2))/2))/2, 0;
(dlc2*((m0*cos(theta1)*(cos(theta1)*(h0 + lc1/2) + 2*cos(theta1)*(h0 + lc2/2)))/2 + (m0*sin(theta1)*(sin(theta1)*(h0 + lc1/2) + 2*sin(theta1)*(h0 + lc2/2)))/2))/2 - dtheta1*((m0*sin(theta1)*(h0 + lc2/2)*(cos(theta1)*(h0 + lc1/2) + 2*cos(theta1)*(h0 + lc2/2)))/2 - (m0*cos(theta1)*(sin(theta1)*(h0 + lc1/2) + 2*sin(theta1)*(h0 + lc2/2))*(h0 + lc2/2))/2) - dtheta2*((m0*sin(theta1)*(h0 + lc2/2)*(cos(theta1)*(h0 + lc1/2) + 2*cos(theta1)*(h0 + lc2/2)))/2 - (m0*cos(theta1)*(sin(theta1)*(h0 + lc1/2) + 2*sin(theta1)*(h0 + lc2/2))*(h0 + lc2/2))/2),- (dtheta1*((m0*cos(theta1)^2*(h0 + lc2/2))/2 + (m0*sin(theta1)^2*(h0 + lc2/2))/2))/2 - (dtheta2*((m0*cos(theta1)^2*(h0 + lc2/2))/2 + (m0*sin(theta1)^2*(h0 + lc2/2))/2))/2 - (dlc2*m0*sin(theta1))/8 - (dtheta1*m0*cos(theta1)*(h0 + lc2/2))/4 - (dtheta2*m0*cos(theta1)*(h0 + lc2/2))/4,(dlc2*((m0*cos(theta1)^2*(2*h0 + lc2))/4 + (m0*sin(theta1)^2*(2*h0 + lc2))/4))/2, - dtheta1*((m0*cos(theta1)^2*(h0 + lc2/2))/2 + (m0*sin(theta1)^2*(h0 + lc2/2))/2) - (dtheta2*((m0*cos(theta1)^2*(h0 + lc2/2))/2 + (m0*sin(theta1)^2*(h0 + lc2/2))/2))/2 - (dtheta2*((m0*cos(theta1)^2*(2*h0 + lc2))/4 + (m0*sin(theta1)^2*(2*h0 + lc2))/4))/2;
dtheta1*((m0*cos(theta1)*(cos(theta1)*(h0 + lc1/2) + 2*cos(theta1)*(h0 + lc2/2)))/2 + (m0*sin(theta1)*(sin(theta1)*(h0 + lc1/2) + 2*sin(theta1)*(h0 + lc2/2)))/2) + (dtheta2*((m0*cos(theta1)*(cos(theta1)*(h0 + lc1/2) + 2*cos(theta1)*(h0 + lc2/2)))/2 + (m0*sin(theta1)*(sin(theta1)*(h0 + lc1/2) + 2*sin(theta1)*(h0 + lc2/2)))/2))/2,- (dtheta1*m0*sin(theta1))/4 - (dtheta2*m0*sin(theta1))/8, dtheta1*((m0*cos(theta1)^2*(h0 + lc2/2))/2 + (m0*sin(theta1)^2*(h0 + lc2/2))/2) + (dtheta2*((m0*cos(theta1)^2*(2*h0 + lc2))/4 + (m0*sin(theta1)^2*(2*h0 + lc2))/4))/2, 0];
 

G =[- (g*m0*(sin(theta1)*(h0 + lc1/2) + 2*sin(theta1)*(h0 + lc2/2)))/2 - g*m0*sin(theta1)*(h0 + lc1/2);
 (3*g*m0)/4 + (3*g*m0*cos(theta1))/4;
-(g*m0*sin(theta1)*(h0 + lc2/2))/2;
(g*m0*cos(theta1))/2];

else

M =[ Iyy3 + Iyy6 + ((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2)*((m0*sin(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 - (m0*cos(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2) - ((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2)*((m0*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + m0*sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1)) + (m0*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2))^2)/2 + (m0*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2))^2)/2 - ((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2)*((m0*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 - 2*m0*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2) + m0*sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) - (3*m0*cos(theta1)*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2))/2) + ((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2)*(((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2)*((3*m0*cos(theta1)^2)/2 + (3*m0*sin(theta1)^2)/2) + (m0*sin(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 - (m0*cos(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + (3*m0*cos(theta1)*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2))/2) + m0*cos(theta1)^2*(h0 + (lc1*sin(theta1/2))/theta1)^2 + m0*sin(theta1)^2*(h0 + (lc1*sin(theta1/2))/theta1)^2, (sin(theta1/2)*(((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2)*((3*m0*cos(theta1)^2)/2 + (3*m0*sin(theta1)^2)/2) + (m0*sin(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 - (m0*cos(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + (3*m0*cos(theta1)*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2))/2))/theta1 - (sin(theta1/2)*((m0*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 - 2*m0*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2) + m0*sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) - (3*m0*cos(theta1)*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2))/2))/theta1, Iyy6 + ((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*(((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2)*((m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2) + (m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 - (m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + (m0*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) + ((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*(((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2)*((m0*cos(theta1)^2)/2 + (m0*sin(theta1)^2)/2) + (m0*sin(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 - (m0*cos(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + (m0*cos(theta1)*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2))/2) + ((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2)*((m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2 - (m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2) + (m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 - (m0*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2, (sin(theta2/2)*(((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2)*((m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2) + (m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 - (m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + (m0*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2))/theta2 + (sin(theta2/2)*(((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2)*((m0*cos(theta1)^2)/2 + (m0*sin(theta1)^2)/2) + (m0*sin(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 - (m0*cos(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + (m0*cos(theta1)*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2))/2))/theta2;
((2*m0*sin(theta1/2))/theta1 + (3*m0*sin(theta1/2)*cos(theta1))/(2*theta1))*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2) + ((sin(theta1/2)*((3*m0*cos(theta1)^2)/2 + (3*m0*sin(theta1)^2)/2))/theta1 + (3*m0*sin(theta1/2)*cos(theta1))/(2*theta1))*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2) + (sin(theta1/2)*((m0*sin(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 - (m0*cos(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2))/theta1 - (sin(theta1/2)*((m0*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + m0*sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1)))/theta1, (sin(theta1/2)*((2*m0*sin(theta1/2))/theta1 + (3*m0*sin(theta1/2)*cos(theta1))/(2*theta1)))/theta1 + (sin(theta1/2)*((sin(theta1/2)*((3*m0*cos(theta1)^2)/2 + (3*m0*sin(theta1)^2)/2))/theta1 + (3*m0*sin(theta1/2)*cos(theta1))/(2*theta1)))/theta1,((sin(theta1/2)*((m0*cos(theta1)^2)/2 + (m0*sin(theta1)^2)/2))/theta1 + (m0*sin(theta1/2)*cos(theta1))/(2*theta1))*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2) + ((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*((sin(theta1/2)*((m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2))/theta1 + (m0*sin(theta1/2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/(2*theta1)) + (sin(theta1/2)*((m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2 - (m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2))/theta1 - (m0*sin(theta1/2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/(2*theta1), (sin(theta2/2)*((sin(theta1/2)*((m0*cos(theta1)^2)/2 + (m0*sin(theta1)^2)/2))/theta1 + (m0*sin(theta1/2)*cos(theta1))/(2*theta1)))/theta2 + (sin(theta2/2)*((sin(theta1/2)*((m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2))/theta1 + (m0*sin(theta1/2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/(2*theta1)))/theta2;
Iyy6 + ((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*((m0*sin(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 - (m0*cos(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2) + ((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2)*(((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*((m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2) + ((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*((m0*cos(theta1)^2)/2 + (m0*sin(theta1)^2)/2) + (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2 - (m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2) + ((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2)*((m0*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 - (m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (m0*cos(theta1)*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2))/2) + ((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*((m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 - (m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2) + (m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + (m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2, (sin(theta1/2)*(((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*((m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2) + ((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*((m0*cos(theta1)^2)/2 + (m0*sin(theta1)^2)/2) + (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2 - (m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2))/theta1 + (sin(theta1/2)*((m0*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 - (m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (m0*cos(theta1)*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2))/2))/theta1,Iyy6 + ((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*(((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*((m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2) + ((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*((m0*cos(theta1)^2)/2 + (m0*sin(theta1)^2)/2) + (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2 - (m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2) + ((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*(((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*((m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2)/2 + (m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2)/2) + ((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*((m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2)) + ((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*((m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2 - (m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2) + (m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2*(h0 + (lc2*sin(theta2/2))/theta2)^2)/2 + (m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2*(h0 + (lc2*sin(theta2/2))/theta2)^2)/2, (sin(theta2/2)*(((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*((m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2) + ((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*((m0*cos(theta1)^2)/2 + (m0*sin(theta1)^2)/2) + (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2 - (m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2))/theta2 + (sin(theta2/2)*(((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*((m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2)/2 + (m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2)/2) + ((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*((m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2)))/theta2;
((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2)*((m0*sin(theta2/2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/(2*theta2) + (m0*sin(theta2/2)*cos(theta1))/(2*theta2)) + ((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2)*((sin(theta2/2)*((m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2))/theta2 + (sin(theta2/2)*((m0*cos(theta1)^2)/2 + (m0*sin(theta1)^2)/2))/theta2) + (sin(theta2/2)*((m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 - (m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2))/theta2 + (sin(theta2/2)*((m0*sin(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 - (m0*cos(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2))/theta2,(sin(theta1/2)*((m0*sin(theta2/2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/(2*theta2) + (m0*sin(theta2/2)*cos(theta1))/(2*theta2)))/theta1 + (sin(theta1/2)*((sin(theta2/2)*((m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2))/theta2 + (sin(theta2/2)*((m0*cos(theta1)^2)/2 + (m0*sin(theta1)^2)/2))/theta2))/theta1,((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*((sin(theta2/2)*((m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2))/theta2 + (sin(theta2/2)*((m0*cos(theta1)^2)/2 + (m0*sin(theta1)^2)/2))/theta2) + ((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*((sin(theta2/2)*((m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2)/2 + (m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2)/2))/theta2 + (sin(theta2/2)*((m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2))/theta2) + (sin(theta2/2)*((m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2 - (m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2))/theta2, (sin(theta2/2)*((sin(theta2/2)*((m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2))/theta2 + (sin(theta2/2)*((m0*cos(theta1)^2)/2 + (m0*sin(theta1)^2)/2))/theta2))/theta2 + (sin(theta2/2)*((sin(theta2/2)*((m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2)/2 + (m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2)/2))/theta2 + (sin(theta2/2)*((m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2))/theta2))/theta2];
 
C =[(dtheta2*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2) + (dlc2*sin(theta2/2))/theta2)*((m0*cos(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + (m0*sin(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2) + dtheta2*((m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 - (m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2) + (dtheta1*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2) + (dlc1*sin(theta1/2))/theta1)*((m0*cos(theta1)^2*(2*h0 + (2*lc1*sin(theta1/2))/theta1))/2 + (m0*sin(theta1)^2*(2*h0 + (2*lc1*sin(theta1/2))/theta1))/2 + (m0*cos(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + (m0*sin(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2) + (dtheta2*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2) + (dlc2*sin(theta2/2))/theta2)*((m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + (m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2) - ((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2)*(dtheta1*((m0*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + m0*cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1)) + (m0*(dtheta2*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2) + (dlc2*sin(theta2/2))/theta2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 + (3*m0*sin(theta1)*(dtheta1*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2) + (dlc1*sin(theta1/2))/theta1))/2 + (m0*sin(theta1)*(dtheta2*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2) + (dlc2*sin(theta2/2))/theta2))/2 + (3*dtheta1*m0*sin(theta1)*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2))/2 + (dtheta2*m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2) - ((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2)*(dtheta2*((m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2) + (dtheta2*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2) + (dlc2*sin(theta2/2))/theta2)*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) + dtheta1*((m0*cos(theta1)^2*(2*h0 + (2*lc1*sin(theta1/2))/theta1))/2 + (m0*sin(theta1)^2*(2*h0 + (2*lc1*sin(theta1/2))/theta1))/2 + (m0*cos(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + (m0*sin(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2)) + dtheta1*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2)*((m0*cos(theta1)^2*(2*h0 + (2*lc1*sin(theta1/2))/theta1))/2 + (m0*sin(theta1)^2*(2*h0 + (2*lc1*sin(theta1/2))/theta1))/2 + (m0*cos(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + (m0*sin(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2), - (sin(theta1/2)*(dtheta1*((m0*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + m0*cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1)) + (m0*(dtheta2*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2) + (dlc2*sin(theta2/2))/theta2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 + (3*m0*sin(theta1)*(dtheta1*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2) + (dlc1*sin(theta1/2))/theta1))/2 + (m0*sin(theta1)*(dtheta2*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2) + (dlc2*sin(theta2/2))/theta2))/2 + (3*dtheta1*m0*sin(theta1)*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2))/2 + (dtheta2*m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2))/theta1 - (sin(theta1/2)*(dtheta2*((m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2) + (dtheta2*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2) + (dlc2*sin(theta2/2))/theta2)*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) + dtheta1*((m0*cos(theta1)^2*(2*h0 + (2*lc1*sin(theta1/2))/theta1))/2 + (m0*sin(theta1)^2*(2*h0 + (2*lc1*sin(theta1/2))/theta1))/2 + (m0*cos(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + (m0*sin(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2)))/theta1, ((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*((dtheta1*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2) + (dlc1*sin(theta1/2))/theta1)*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) - dtheta2*((m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2*(h0 + (lc2*sin(theta2/2))/theta2))/2) + (dtheta2*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2) + (dlc2*sin(theta2/2))/theta2)*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) - dtheta1*((m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + (m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2) + dtheta1*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2)*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)) - dtheta1*((m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 - (m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2) - ((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*(dtheta2*((m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2) + dtheta1*((m0*cos(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + (m0*sin(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2) + (dtheta2*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2) + (dlc2*sin(theta2/2))/theta2)*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)) + (dtheta2*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2) + (dlc2*sin(theta2/2))/theta2)*((m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2*(h0 + (lc2*sin(theta2/2))/theta2))/2) + (dtheta1*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2) + (dlc1*sin(theta1/2))/theta1)*((m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2) + (dtheta2*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2) + (dlc2*sin(theta2/2))/theta2)*((m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2) + dtheta1*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2)*((m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2), (sin(theta2/2)*((dtheta1*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2) + (dlc1*sin(theta1/2))/theta1)*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) - dtheta2*((m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2*(h0 + (lc2*sin(theta2/2))/theta2))/2) + (dtheta2*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2) + (dlc2*sin(theta2/2))/theta2)*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) - dtheta1*((m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + (m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2) + dtheta1*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2)*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)))/theta2 - (sin(theta2/2)*(dtheta2*((m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2) + dtheta1*((m0*cos(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + (m0*sin(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2) + (dtheta2*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2) + (dlc2*sin(theta2/2))/theta2)*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)))/theta2;
(dtheta1*sin(theta1/2)*((m0*cos(theta1)^2*(2*h0 + (2*lc1*sin(theta1/2))/theta1))/2 + (m0*sin(theta1)^2*(2*h0 + (2*lc1*sin(theta1/2))/theta1))/2 + (m0*cos(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + (m0*sin(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2))/theta1 - (3*dtheta1*m0*sin(theta1/2)*sin(theta1)*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2))/(2*theta1), -(3*dtheta1*m0*sin(theta1/2)^2*sin(theta1))/(2*theta1^2), (dtheta1*sin(theta1/2)*((m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2))/theta1 + (dtheta1*sin(theta1/2)*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2))/theta1, (dtheta1*sin(theta1/2)*sin(theta2/2)*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2))/(theta1*theta2);
dtheta1*((m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 - (m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2) - ((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2)*(((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*((dtheta1*m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 + (dtheta2*m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2) + (m0*(dtheta2*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2) + (dlc2*sin(theta2/2))/theta2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 + (dtheta1*m0*sin(theta1)*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2))/2 + (dtheta1*m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (dtheta2*m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2) + dtheta2*((m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 - (m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2) + ((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*(dtheta1*((m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + (m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2) + dtheta2*((m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + (m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2)) + (dtheta2*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2) + (dlc2*sin(theta2/2))/theta2)*((m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + (m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2) - ((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2)*(dtheta1*((m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2) + dtheta2*((m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2) + ((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*(dtheta1*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) + dtheta2*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)) + (dtheta2*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2) + (dlc2*sin(theta2/2))/theta2)*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)) + dtheta1*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*((m0*cos(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + (m0*sin(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2),- (sin(theta1/2)*(((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*((dtheta1*m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 + (dtheta2*m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2) + (m0*(dtheta2*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2) + (dlc2*sin(theta2/2))/theta2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 + (dtheta1*m0*sin(theta1)*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2))/2 + (dtheta1*m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (dtheta2*m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2))/theta1 - (sin(theta1/2)*(dtheta1*((m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2) + dtheta2*((m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2) + ((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*(dtheta1*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) + dtheta2*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)) + (dtheta2*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2) + (dlc2*sin(theta2/2))/theta2)*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)))/theta1, ((m0*(2*h0 + (2*lc2*sin(theta2/2))/theta2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2)/4 + (m0*(2*h0 + (2*lc2*sin(theta2/2))/theta2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2)/4)*(dtheta2*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2) + (dlc2*sin(theta2/2))/theta2) - ((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*(dtheta1*((m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2*(h0 + (lc2*sin(theta2/2))/theta2))/2) + dtheta2*((m0*(2*h0 + (2*lc2*sin(theta2/2))/theta2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2)/4 + (m0*(2*h0 + (2*lc2*sin(theta2/2))/theta2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2)/4) - dtheta1*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)) - ((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*(dtheta1*((m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2) + dtheta2*((m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2) + ((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*(dtheta1*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) + dtheta2*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)) + (dtheta2*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2) + (dlc2*sin(theta2/2))/theta2)*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)) + ((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*(dtheta1*((m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2*(h0 + (lc2*sin(theta2/2))/theta2))/2) + dtheta2*((m0*(2*h0 + (2*lc2*sin(theta2/2))/theta2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2)/4 + (m0*(2*h0 + (2*lc2*sin(theta2/2))/theta2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2)/4)) + dtheta1*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*((m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2), - (sin(theta2/2)*(dtheta1*((m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2*(h0 + (lc2*sin(theta2/2))/theta2))/2) + dtheta2*((m0*(2*h0 + (2*lc2*sin(theta2/2))/theta2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2)/4 + (m0*(2*h0 + (2*lc2*sin(theta2/2))/theta2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2)/4) - dtheta1*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)))/theta2 - (sin(theta2/2)*(dtheta1*((m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2) + dtheta2*((m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2) + ((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*(dtheta1*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) + dtheta2*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)) + (dtheta2*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2) + (dlc2*sin(theta2/2))/theta2)*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)))/theta2;
(sin(theta2/2)*(dtheta1*((m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + (m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2) + dtheta2*((m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + (m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2)))/theta2 - ((sin(theta2/2)*((dtheta1*m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 + (dtheta2*m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2))/theta2 + (dtheta1*m0*sin(theta2/2)*sin(theta1))/(2*theta2))*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2) + (dtheta1*sin(theta2/2)*((m0*cos(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2) + cos(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + cos(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + (m0*sin(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2))/theta2 - (sin(theta2/2)*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2)*(dtheta1*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) + dtheta2*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)))/theta2,- (sin(theta1/2)*((sin(theta2/2)*((dtheta1*m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 + (dtheta2*m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2))/theta2 + (dtheta1*m0*sin(theta2/2)*sin(theta1))/(2*theta2)))/theta1 - (sin(theta1/2)*sin(theta2/2)*(dtheta1*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) + dtheta2*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)))/(theta1*theta2), (sin(theta2/2)*(dtheta1*((m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (m0*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2*(h0 + (lc2*sin(theta2/2))/theta2))/2) + dtheta2*((m0*(2*h0 + (2*lc2*sin(theta2/2))/theta2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2)/4 + (m0*(2*h0 + (2*lc2*sin(theta2/2))/theta2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2)/4)))/theta2 + (dtheta1*sin(theta2/2)*((m0*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (m0*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(h0 + (lc2*sin(theta2/2))/theta2))/2))/theta2 - (sin(theta2/2)*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*(dtheta1*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) + dtheta2*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)))/theta2 + (dtheta1*sin(theta2/2)*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2))/theta2, (dtheta1*sin(theta2/2)^2*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2))/theta2^2 - (sin(theta2/2)^2*(dtheta1*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) + dtheta2*((m0*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m0*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)))/theta2^2];
 
G =[
(3*g*m0*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2))/2 - (g*m0*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2) + sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1) + sin(theta1)*(h0 + (lc2*sin(theta2/2))/theta2)))/2 + (3*g*m0*cos(theta1)*((lc1*cos(theta1/2))/(2*theta1) - (lc1*sin(theta1/2))/theta1^2))/2 - g*m0*sin(theta1)*(h0 + (lc1*sin(theta1/2))/theta1);
(3*g*m0*sin(theta1/2))/(2*theta1) + (3*g*m0*sin(theta1/2)*cos(theta1))/(2*theta1);
(g*m0*cos(theta1)*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2))/2 - (g*m0*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(h0 + (lc2*sin(theta2/2))/theta2))/2 + (g*m0*((lc2*cos(theta2/2))/(2*theta2) - (lc2*sin(theta2/2))/theta2^2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2;
(g*m0*sin(theta2/2)*cos(theta1))/(2*theta2) + (g*m0*sin(theta2/2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/(2*theta2); 
];
end
    tau_f_array(1:4,i) = M * [ddtheta1;ddlc1;ddtheta2;ddlc2] + C * [dtheta1;dlc1;dtheta2;dlc2] + G;
    Mi(1:4,i)  =  M * [ddtheta1;ddlc1;ddtheta2;ddlc2];
    Ci(1:4,i) = C * [dtheta1;dlc1;dtheta2;dlc2];
    Gi(1:4,i) = G;
    end
state_array = [theta1_array,dtheta1_array,lc1_array,dlc1_array,theta2_array,dtheta2_array,lc2_array,dlc2_array];
output.output_array = tau_f_array;
output.state_array = state_array;
output.Mi = Mi;
output.Gi = Gi;
output.Ci = Ci;
end 