function [output] = funcCompuMCG_v1(stateVarArr)
    m2 = (100 + 34*2 + 25*5)/1000; %kg
    m1 = m2;
    h0 = 0.01; %m
    g = 9.8
    Iyy2 = 0;
    Iyy5 = 0;
a1 = 0.02;
for i  =  1:length(stateVarArr)
theta1 = stateVarArr(i,1);
dtheta1 = stateVarArr(i,2);
lc1 = stateVarArr(i,3);
dlc1 = stateVarArr(i,4);
theta2 = stateVarArr(i,5);
dtheta2 = stateVarArr(i,6);
lc2 = stateVarArr(i,7);
dlc2 = stateVarArr(i,8);

if theta1 <= 0.001
M4x4{i} = [(m2*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2))^2)/2 - ((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((m2*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m1*sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1))/2) + (m2*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2))^2)/2 + ((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*(((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((m1*cos(theta1)^2)/2 + m2*cos(theta1)^2 + (m1*sin(theta1)^2)/2 + m2*sin(theta1)^2) + ((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((m1*cos(theta1))/2 + m2*cos(theta1)) + (m2*sin(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 - (m2*cos(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*sin(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 - (m2*cos(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2) + (m2*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2))^2)/2 - ((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((m2*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 - ((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*(m1/2 + m2) - ((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((m1*cos(theta1))/2 + m2*cos(theta1)) + (m2*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m1*sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1))/2) + ((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((m2*sin(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 - (m2*cos(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*sin(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 - (m2*cos(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2) + (m2*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2))^2)/2 + m1*cos(theta1)^2*(a1 + (lc1*tan(theta1/2))/theta1)^2 + (m2*cos(theta1)^2*(a1 + (lc2*tan(theta2/2))/theta2)^2)/2 + m1*sin(theta1)^2*(a1 + (lc1*tan(theta1/2))/theta1)^2 + (m2*sin(theta1)^2*(a1 + (lc2*tan(theta2/2))/theta2)^2)/2 + (m2*cos(theta1)^2*(2*a1 + (lc1*tan(theta1/2))/theta1 + (lc2*tan(theta2/2))/theta2)^2)/2 + (m2*sin(theta1)^2*(2*a1 + (lc1*tan(theta1/2))/theta1 + (lc2*tan(theta2/2))/theta2)^2)/2, (tan(theta1/2)*(((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((m1*cos(theta1)^2)/2 + m2*cos(theta1)^2 + (m1*sin(theta1)^2)/2 + m2*sin(theta1)^2) + ((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((m1*cos(theta1))/2 + m2*cos(theta1)) + (m2*sin(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 - (m2*cos(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*sin(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 - (m2*cos(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2))/theta1 - (tan(theta1/2)*((m2*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 - ((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*(m1/2 + m2) - ((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((m1*cos(theta1))/2 + m2*cos(theta1)) + (m2*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m1*sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1))/2))/theta1, ((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*(((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*(m2*cos(theta1)^2 + m2*sin(theta1)^2) + (m2*sin(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 - (m2*cos(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*sin(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 - (m2*cos(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + m2*cos(theta1)*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)) + ((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*(((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2) + (m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 - (m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) - ((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2)*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2) + (m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2)^2)/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2)^2)/2 - (m2*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2, (tan(theta2/2)*(((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*(m2*cos(theta1)^2 + m2*sin(theta1)^2) + (m2*sin(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 - (m2*cos(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*sin(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 - (m2*cos(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + m2*cos(theta1)*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)))/theta2 + (tan(theta2/2)*(((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2) + (m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 - (m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2))/theta2;
 ((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((tan(theta1/2)*((m1*cos(theta1)^2)/2 + m2*cos(theta1)^2 + (m1*sin(theta1)^2)/2 + m2*sin(theta1)^2))/theta1 + (tan(theta1/2)*((m1*cos(theta1))/2 + m2*cos(theta1)))/theta1) + ((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((tan(theta1/2)*(m1/2 + m2))/theta1 + (tan(theta1/2)*((m1*cos(theta1))/2 + m2*cos(theta1)))/theta1) + (tan(theta1/2)*((m2*sin(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 - (m2*cos(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*sin(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 - (m2*cos(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2))/theta1 - (tan(theta1/2)*((m2*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m1*sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1))/2))/theta1,(tan(theta1/2)*((tan(theta1/2)*((m1*cos(theta1)^2)/2 + m2*cos(theta1)^2 + (m1*sin(theta1)^2)/2 + m2*sin(theta1)^2))/theta1 + (tan(theta1/2)*((m1*cos(theta1))/2 + m2*cos(theta1)))/theta1))/theta1 + (tan(theta1/2)*((tan(theta1/2)*(m1/2 + m2))/theta1 + (tan(theta1/2)*((m1*cos(theta1))/2 + m2*cos(theta1)))/theta1))/theta1, ((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*((tan(theta1/2)*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2))/theta1 + (m2*tan(theta1/2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/(2*theta1)) + ((tan(theta1/2)*(m2*cos(theta1)^2 + m2*sin(theta1)^2))/theta1 + (m2*tan(theta1/2)*cos(theta1))/theta1)*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) - (tan(theta1/2)*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2))/theta1 - (m2*tan(theta1/2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/(2*theta1), (tan(theta2/2)*((tan(theta1/2)*(m2*cos(theta1)^2 + m2*sin(theta1)^2))/theta1 + (m2*tan(theta1/2)*cos(theta1))/theta1))/theta2 + (tan(theta2/2)*((tan(theta1/2)*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2))/theta1 + (m2*tan(theta1/2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/(2*theta1)))/theta2;
 ((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*((m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 - (m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2) + ((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*(((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*(m2*cos(theta1)^2 + m2*sin(theta1)^2) + ((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2) - (m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2) + ((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*((m2*sin(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 - (m2*cos(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*sin(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 - (m2*cos(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2) + ((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((m2*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 - (m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2 + m2*cos(theta1)*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)) + (m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2)^2)/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2)^2)/2 + (m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2, (tan(theta1/2)*(((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*(m2*cos(theta1)^2 + m2*sin(theta1)^2) + ((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2) - (m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2))/theta1 + (tan(theta1/2)*((m2*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 - (m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2 + m2*cos(theta1)*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)))/theta1,((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*(((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*((m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2)/2 + (m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2)/2) + ((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2)) + ((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*(((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*(m2*cos(theta1)^2 + m2*sin(theta1)^2) + ((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2) - (m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2) - ((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2)*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2*(a1 + (lc2*tan(theta2/2))/theta2)^2 + m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2*(a1 + (lc2*tan(theta2/2))/theta2)^2, (tan(theta2/2)*(((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*((m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2)/2 + (m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2)/2) + ((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2)))/theta2 + (tan(theta2/2)*(((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*(m2*cos(theta1)^2 + m2*sin(theta1)^2) + ((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2) - (m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2))/theta2;
((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((m2*tan(theta2/2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/(2*theta2) + (m2*tan(theta2/2)*cos(theta1))/theta2) + ((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((tan(theta2/2)*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2))/theta2 + (tan(theta2/2)*(m2*cos(theta1)^2 + m2*sin(theta1)^2))/theta2) + (tan(theta2/2)*((m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 - (m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2))/theta2 + (tan(theta2/2)*((m2*sin(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 - (m2*cos(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*sin(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 - (m2*cos(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2))/theta2,(tan(theta1/2)*((m2*tan(theta2/2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/(2*theta2) + (m2*tan(theta2/2)*cos(theta1))/theta2))/theta1 + (tan(theta1/2)*((tan(theta2/2)*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2))/theta2 + (tan(theta2/2)*(m2*cos(theta1)^2 + m2*sin(theta1)^2))/theta2))/theta1, ((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*((tan(theta2/2)*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2))/theta2 + (tan(theta2/2)*(m2*cos(theta1)^2 + m2*sin(theta1)^2))/theta2) + ((tan(theta2/2)*((m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2)/2 + (m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2)/2))/theta2 + (tan(theta2/2)*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2))/theta2)*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) - (tan(theta2/2)*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2))/theta2, (tan(theta2/2)*((tan(theta2/2)*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2))/theta2 + (tan(theta2/2)*(m2*cos(theta1)^2 + m2*sin(theta1)^2))/theta2))/theta2 + (tan(theta2/2)*((tan(theta2/2)*((m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2)/2 + (m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2)/2))/theta2 + (tan(theta2/2)*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2))/theta2))/theta2;
];    
C4x4{i} = [(dtheta2*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + (dlc2*tan(theta2/2))/theta2)*((m2*cos(theta1)^2*(2*a1 + (2*lc2*tan(theta2/2))/theta2))/4 + (m2*sin(theta1)^2*(2*a1 + (2*lc2*tan(theta2/2))/theta2))/4 + (m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2) - ((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*(dtheta2*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2) + (dtheta2*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + (dlc2*tan(theta2/2))/theta2)*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) + dtheta1*((m2*sin(theta1)^2*(4*a1 + (2*lc1*tan(theta1/2))/theta1 + (2*lc2*tan(theta2/2))/theta2))/4 + (m1*cos(theta1)^2*(2*a1 + (2*lc1*tan(theta1/2))/theta1))/2 + (m1*sin(theta1)^2*(2*a1 + (2*lc1*tan(theta1/2))/theta1))/2 + (m2*cos(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*sin(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*cos(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*sin(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*cos(theta1)^2*(4*a1 + (2*lc1*tan(theta1/2))/theta1 + (2*lc2*tan(theta2/2))/theta2))/4)) - ((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((dtheta1*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2) + (dlc1*tan(theta1/2))/theta1)*((m1*sin(theta1))/2 + m2*sin(theta1)) + dtheta1*((m2*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m1*cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1))/2) + m2*sin(theta1)*(dtheta2*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + (dlc2*tan(theta2/2))/theta2) + (m2*(dtheta2*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + (dlc2*tan(theta2/2))/theta2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 + dtheta1*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((m1*sin(theta1))/2 + m2*sin(theta1)) + (dtheta2*m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2) + (dtheta2*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + (dlc2*tan(theta2/2))/theta2)*((m2*sin(theta1)^2*(4*a1 + (2*lc1*tan(theta1/2))/theta1 + (2*lc2*tan(theta2/2))/theta2))/4 + (m2*cos(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*sin(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*cos(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*sin(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*cos(theta1)^2*(4*a1 + (2*lc1*tan(theta1/2))/theta1 + (2*lc2*tan(theta2/2))/theta2))/4) + (dtheta1*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2) + (dlc1*tan(theta1/2))/theta1)*((m2*sin(theta1)^2*(4*a1 + (2*lc1*tan(theta1/2))/theta1 + (2*lc2*tan(theta2/2))/theta2))/4 + (m1*cos(theta1)^2*(2*a1 + (2*lc1*tan(theta1/2))/theta1))/2 + (m1*sin(theta1)^2*(2*a1 + (2*lc1*tan(theta1/2))/theta1))/2 + (m2*cos(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*sin(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*cos(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*sin(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*cos(theta1)^2*(4*a1 + (2*lc1*tan(theta1/2))/theta1 + (2*lc2*tan(theta2/2))/theta2))/4) - dtheta2*((m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 - (m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2) + dtheta1*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((m2*sin(theta1)^2*(4*a1 + (2*lc1*tan(theta1/2))/theta1 + (2*lc2*tan(theta2/2))/theta2))/4 + (m1*cos(theta1)^2*(2*a1 + (2*lc1*tan(theta1/2))/theta1))/2 + (m1*sin(theta1)^2*(2*a1 + (2*lc1*tan(theta1/2))/theta1))/2 + (m2*cos(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*sin(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*cos(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*sin(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*cos(theta1)^2*(4*a1 + (2*lc1*tan(theta1/2))/theta1 + (2*lc2*tan(theta2/2))/theta2))/4), - (tan(theta1/2)*((dtheta1*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2) + (dlc1*tan(theta1/2))/theta1)*((m1*sin(theta1))/2 + m2*sin(theta1)) + dtheta1*((m2*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m1*cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1))/2) + m2*sin(theta1)*(dtheta2*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + (dlc2*tan(theta2/2))/theta2) + (m2*(dtheta2*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + (dlc2*tan(theta2/2))/theta2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 + dtheta1*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((m1*sin(theta1))/2 + m2*sin(theta1)) + (dtheta2*m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2))/theta1 - (tan(theta1/2)*(dtheta2*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2) + (dtheta2*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + (dlc2*tan(theta2/2))/theta2)*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) + dtheta1*((m2*sin(theta1)^2*(4*a1 + (2*lc1*tan(theta1/2))/theta1 + (2*lc2*tan(theta2/2))/theta2))/4 + (m1*cos(theta1)^2*(2*a1 + (2*lc1*tan(theta1/2))/theta1))/2 + (m1*sin(theta1)^2*(2*a1 + (2*lc1*tan(theta1/2))/theta1))/2 + (m2*cos(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*sin(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*cos(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*sin(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*cos(theta1)^2*(4*a1 + (2*lc1*tan(theta1/2))/theta1 + (2*lc2*tan(theta2/2))/theta2))/4)))/theta1, (dtheta2*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + (dlc2*tan(theta2/2))/theta2)*((m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*cos(theta1)*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/4 + (m2*sin(theta1)*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/4) - ((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*(dtheta2*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2) + (dtheta2*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + (dlc2*tan(theta2/2))/theta2)*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) + dtheta1*((m2*sin(theta1)^2*(4*a1 + (2*lc1*tan(theta1/2))/theta1 + (2*lc2*tan(theta2/2))/theta2))/4 + (m2*cos(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*sin(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*cos(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*sin(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*cos(theta1)^2*(4*a1 + (2*lc1*tan(theta1/2))/theta1 + (2*lc2*tan(theta2/2))/theta2))/4)) + ((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*((dtheta1*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2) + (dlc1*tan(theta1/2))/theta1)*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) + (dtheta2*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + (dlc2*tan(theta2/2))/theta2)*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) - dtheta2*((m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*cos(theta1)*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/4 + (m2*sin(theta1)*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/4) - dtheta1*((m2*cos(theta1)^2*(2*a1 + (2*lc2*tan(theta2/2))/theta2))/4 + (m2*sin(theta1)^2*(2*a1 + (2*lc2*tan(theta2/2))/theta2))/4 + (m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2) + dtheta1*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)) + dtheta1*((m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 - (m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2) + ((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2)*(dtheta1*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2) + (dlc1*tan(theta1/2))/theta1) + ((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2)*(dtheta2*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + (dlc2*tan(theta2/2))/theta2) + dtheta1*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2)*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2), (tan(theta2/2)*((dtheta1*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2) + (dlc1*tan(theta1/2))/theta1)*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) + (dtheta2*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + (dlc2*tan(theta2/2))/theta2)*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) - dtheta2*((m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*cos(theta1)*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/4 + (m2*sin(theta1)*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/4) - dtheta1*((m2*cos(theta1)^2*(2*a1 + (2*lc2*tan(theta2/2))/theta2))/4 + (m2*sin(theta1)^2*(2*a1 + (2*lc2*tan(theta2/2))/theta2))/4 + (m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2) + dtheta1*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)))/theta2 - (tan(theta2/2)*(dtheta2*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2) + (dtheta2*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + (dlc2*tan(theta2/2))/theta2)*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) + dtheta1*((m2*sin(theta1)^2*(4*a1 + (2*lc1*tan(theta1/2))/theta1 + (2*lc2*tan(theta2/2))/theta2))/4 + (m2*cos(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*sin(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*cos(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*sin(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*cos(theta1)^2*(4*a1 + (2*lc1*tan(theta1/2))/theta1 + (2*lc2*tan(theta2/2))/theta2))/4)))/theta2;
(dtheta1*tan(theta1/2)*((m2*sin(theta1)^2*(4*a1 + (2*lc1*tan(theta1/2))/theta1 + (2*lc2*tan(theta2/2))/theta2))/4 + (m1*cos(theta1)^2*(2*a1 + (2*lc1*tan(theta1/2))/theta1))/2 + (m1*sin(theta1)^2*(2*a1 + (2*lc1*tan(theta1/2))/theta1))/2 + (m2*cos(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*sin(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*cos(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*sin(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*cos(theta1)^2*(4*a1 + (2*lc1*tan(theta1/2))/theta1 + (2*lc2*tan(theta2/2))/theta2))/4))/theta1 - (dtheta1*tan(theta1/2)*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((m1*sin(theta1))/2 + m2*sin(theta1)))/theta1, -(dtheta1*tan(theta1/2)^2*((m1*sin(theta1))/2 + m2*sin(theta1)))/theta1^2, (dtheta1*tan(theta1/2)*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2))/theta1 + (dtheta1*tan(theta1/2)*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2))/theta1, (dtheta1*tan(theta1/2)*tan(theta2/2)*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2))/(theta1*theta2);
((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*(dtheta2*((m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*cos(theta1)*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/4 + (m2*sin(theta1)*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/4) + dtheta1*((m2*cos(theta1)^2*(2*a1 + (2*lc2*tan(theta2/2))/theta2))/4 + (m2*sin(theta1)^2*(2*a1 + (2*lc2*tan(theta2/2))/theta2))/4 + (m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2)) + (dtheta2*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + (dlc2*tan(theta2/2))/theta2)*((m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*cos(theta1)*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/4 + (m2*sin(theta1)*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/4) - ((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*(dtheta1*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2) + dtheta2*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2) + ((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*(dtheta1*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) + dtheta2*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)) + (dtheta2*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + (dlc2*tan(theta2/2))/theta2)*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)) - dtheta2*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2)^2)/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2)^2)/2 + (m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 - (m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2) - ((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*(((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*((dtheta1*m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 + (dtheta2*m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2) + (m2*(dtheta2*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + (dlc2*tan(theta2/2))/theta2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 + dtheta1*m2*sin(theta1)*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + (dtheta1*m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (dtheta2*m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2) - dtheta1*((m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 - (m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2) + dtheta1*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*((m2*sin(theta1)^2*(4*a1 + (2*lc1*tan(theta1/2))/theta1 + (2*lc2*tan(theta2/2))/theta2))/4 + (m2*cos(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*sin(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*cos(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*sin(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*cos(theta1)^2*(4*a1 + (2*lc1*tan(theta1/2))/theta1 + (2*lc2*tan(theta2/2))/theta2))/4), - (tan(theta1/2)*(dtheta1*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2) + dtheta2*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2) + ((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*(dtheta1*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) + dtheta2*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)) + (dtheta2*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + (dlc2*tan(theta2/2))/theta2)*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)))/theta1 - (tan(theta1/2)*(((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*((dtheta1*m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 + (dtheta2*m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2) + (m2*(dtheta2*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + (dlc2*tan(theta2/2))/theta2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 + dtheta1*m2*sin(theta1)*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + (dtheta1*m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (dtheta2*m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2))/theta1, ((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*(dtheta1*((m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*cos(theta1)*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/4 + (m2*sin(theta1)*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/4) + dtheta2*((m2*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2)/2 + (m2*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2)/2)) - ((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*(dtheta1*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2) + dtheta2*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2) + ((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*(dtheta1*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) + dtheta2*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)) + (dtheta2*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + (dlc2*tan(theta2/2))/theta2)*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)) - ((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*(dtheta1*((m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*cos(theta1)*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/4 + (m2*sin(theta1)*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/4) + dtheta2*((m2*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2)/2 + (m2*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2)/2) - dtheta1*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)) + ((m2*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2)/2 + (m2*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2)/2)*(dtheta2*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + (dlc2*tan(theta2/2))/theta2) + dtheta1*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2)*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2), - (tan(theta2/2)*(dtheta1*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2) + dtheta2*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2) + ((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*(dtheta1*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) + dtheta2*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)) + (dtheta2*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) + (dlc2*tan(theta2/2))/theta2)*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)))/theta2 - (tan(theta2/2)*(dtheta1*((m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*cos(theta1)*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/4 + (m2*sin(theta1)*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/4) + dtheta2*((m2*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2)/2 + (m2*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2)/2) - dtheta1*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)))/theta2;
(tan(theta2/2)*(dtheta2*((m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*cos(theta1)*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/4 + (m2*sin(theta1)*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/4) + dtheta1*((m2*cos(theta1)^2*(2*a1 + (2*lc2*tan(theta2/2))/theta2))/4 + (m2*sin(theta1)^2*(2*a1 + (2*lc2*tan(theta2/2))/theta2))/4 + (m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2)))/theta2 - ((tan(theta2/2)*((dtheta1*m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 + (dtheta2*m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2))/theta2 + (dtheta1*m2*tan(theta2/2)*sin(theta1))/theta2)*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2) - (tan(theta2/2)*((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*(dtheta1*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) + dtheta2*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)))/theta2 + (dtheta1*tan(theta2/2)*((m2*sin(theta1)^2*(4*a1 + (2*lc1*tan(theta1/2))/theta1 + (2*lc2*tan(theta2/2))/theta2))/4 + (m2*cos(theta1)*((cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2) + cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*sin(theta1)*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*cos(theta1)*(cos(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + cos(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*sin(theta1)*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 + (m2*cos(theta1)^2*(4*a1 + (2*lc1*tan(theta1/2))/theta1 + (2*lc2*tan(theta2/2))/theta2))/4))/theta2, - (tan(theta1/2)*((tan(theta2/2)*((dtheta1*m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 + (dtheta2*m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2))/theta2 + (dtheta1*m2*tan(theta2/2)*sin(theta1))/theta2))/theta1 - (tan(theta1/2)*tan(theta2/2)*(dtheta1*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) + dtheta2*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)))/(theta1*theta2), (tan(theta2/2)*(dtheta1*((m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*cos(theta1)*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/4 + (m2*sin(theta1)*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/4) + dtheta2*((m2*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))^2)/2 + (m2*(2*a1 + (2*lc2*tan(theta2/2))/theta2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))^2)/2)))/theta2 + (dtheta1*tan(theta2/2)*((m2*cos(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2))*(a1 + (lc2*tan(theta2/2))/theta2))/2 + (m2*sin(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2))/theta2 - (tan(theta2/2)*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*(dtheta1*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) + dtheta2*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)))/theta2 + (dtheta1*tan(theta2/2)*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2))/theta2, (dtheta1*tan(theta2/2)^2*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2))/theta2^2 - (tan(theta2/2)^2*(dtheta1*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2) + dtheta2*((m2*cos(theta1)*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1)))/2 - (m2*sin(theta1)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2)))/theta2^2;
 ];
G4x1{i} = [((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((g*m1*cos(theta1))/2 + g*m2*cos(theta1)) + ((lc1*(tan(theta1/2)^2/2 + 1/2))/theta1 - (lc1*tan(theta1/2))/theta1^2)*((g*m1)/2 + g*m2) - (g*m2*((cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2) + sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 - (g*m2*(sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1) + sin(theta1)*(a1 + (lc2*tan(theta2/2))/theta2)))/2 - (g*m1*sin(theta1)*(a1 + (lc1*tan(theta1/2))/theta1))/2;
    (tan(theta1/2)*((g*m1)/2 + g*m2))/theta1 + (tan(theta1/2)*((g*m1*cos(theta1))/2 + g*m2*cos(theta1)))/theta1;
    (g*m2*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/2 + g*m2*cos(theta1)*((lc2*(tan(theta2/2)^2/2 + 1/2))/theta2 - (lc2*tan(theta2/2))/theta2^2) - (g*m2*(cos(theta1)*sin(theta2) + cos(theta2)*sin(theta1))*(a1 + (lc2*tan(theta2/2))/theta2))/2;
    (g*m2*tan(theta2/2)*cos(theta1))/theta2 + (g*m2*tan(theta2/2)*(cos(theta1)*cos(theta2) - sin(theta1)*sin(theta2)))/(2*theta2);];
output.detM(i) = det(M4x4{i});
output.detC(i) = det(C4x4{i});
output.rankM(i) = rank(M4x4{i});
end

end

